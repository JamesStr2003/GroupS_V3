View(players)
#Kitchen Sink Model
kitchen_sink <- lm(value_eur ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(kichen_sink, which = 1)
#Kitchen Sink Model
kitchen_sink <- lm(value_eur ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(kitchen_sink, which = 1)
mplot(kitchen_sink, which = 2)
car::vif(kitchen_sink)
#
#Kitchen Sink Model
kitchen_sink <- lm(value_eur ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(kitchen_sink, which = 1)
mplot(kitchen_sink, which = 2)
car::vif(kitchen_sink)
#Model Summary
msummary(kitchen_sink)
car::vif(mod3)
mod3 <-  lm(log_val ~ pace + shooting + passing + physic, data = players3)
#Model with log (It works, going to use 4 variables)
players3 <- players |>
mutate(log_val = log(value_eur))
mod3 <-  lm(log_val ~ pace + shooting + passing + physic, data = players3)
car::vif(mod3)
#Kitchen Sink Model
kitchen_sink <- lm(value_eur ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(kitchen_sink, which = 1)
mplot(kitchen_sink, which = 2)
car::vif(kitchen_sink)
#Model Summary
msummary(kitchen_sink)
#Adding transformation
players <- players |>
mutate(log_value = log(value_eur))
View(players)
#Adding transformation
players <- players |>
mutate(log_value = log(value_eur))
#Transformed Kitchen Sink Model
log_kitchen_sink <- lm(log_value ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(log_kitchen_sink, which = 1)
mplot(log_kitchen_sink, which = 2)
car::vif(log_kitchen_sink)
#Model Summary
msummary(log_kitchen_sink)
#Adding transformation
players <- players |>
mutate(log_value = log(value_eur))
#Transformed Kitchen Sink Model
log_kitchen_sink <- lm(log_value ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players)
#Conditions
mplot(log_kitchen_sink, which = 1)
mplot(log_kitchen_sink, which = 2)
car::vif(log_kitchen_sink)
#Model Summary
msummary(log_kitchen_sink)
best <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending + player_group, data = players, nbest = 1)
with(summary(best), data.frame(rsq, cp, outmat))
#Five variable model
mod <- lm(log_value ~ pace + passing + physic + dribbling + player_groupMidfielder, data = players)
#Five variable model
mod <- lm(log_value ~ pace + passing + physic + dribbling + player_group:Midfielder, data = players)
#Five variable model
mod <- lm(log_value ~ pace + passing + physic + dribbling + Midfielder, data = players)
#Five variable model
mod <- lm(log_value ~ pace + passing + physic + dribbling + player_group, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ pace + passing + physic + dribbling, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ pace + passing + physic, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing*dribbling + pace + physic, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing + dribbling + pace + physic, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing*dribbling + pace + physic, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing* pace + dribbling + physic, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing* physic + dribbling + pace, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing* physic + dribbling + pace, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + pace + player_group, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
attackers <- players3 %>%
filter(player_group == "Attacker")
bigkitch1 <- lm(log_val ~ passing + shooting + pace + physic + dribbling + defending,  data = players3)
msummary(bigkitch1)
mplot(bigkitch1, which = 1)
mplot(bigkitch1, which = 2)
best5 <- regsubsets(log_val ~ pace + shooting + passing + physic + dribbling + defending, data = attackers, nbest = 1)
with(summary(best5), data.frame(rsq, cp, outmat))
car::vif(bigkitch1)
attackers <- players3 %>%
filter(player_group == "Midfielder")
bigkitch1 <- lm(log_val ~ passing + shooting + pace + physic + dribbling + defending,  data = players3)
msummary(bigkitch1)
mplot(bigkitch1, which = 1)
mplot(bigkitch1, which = 2)
best5 <- regsubsets(log_val ~ pace + shooting + passing + physic + dribbling + defending, data = attackers, nbest = 1)
with(summary(best5), data.frame(rsq, cp, outmat))
car::vif(bigkitch1)
attackers <- players3 %>%
filter(player_group == "Midfielder")
bigkitch1 <- lm(log_val ~ passing + pace + physic + dribbling,  data = players3)
msummary(bigkitch1)
mplot(bigkitch1, which = 1)
mplot(bigkitch1, which = 2)
best5 <- regsubsets(log_val ~ pace +  passing + physic + dribbling, data = attackers, nbest = 1)
with(summary(best5), data.frame(rsq, cp, outmat))
car::vif(bigkitch1)
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + player_group, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + pace + player_group, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + pace + player_group, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
players2 <- select(players, "pace", "shooting", "passing", "dribbling", "defending", "physic", "log_value")
ggpairs(players2)
#Kitchen Sink Model
kitchen_sink <- lm(value_eur ~ pace + shooting + passing + physic + dribbling + defending, data = players)
#Conditions
mplot(kitchen_sink, which = 1)
mplot(kitchen_sink, which = 2)
car::vif(kitchen_sink)
#Model Summary
msummary(kitchen_sink)
#Adding transformation
players <- players |>
mutate(log_value = log(value_eur))
#Transformed Kitchen Sink Model
log_kitchen_sink <- lm(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players)
#Conditions
mplot(log_kitchen_sink, which = 1)
mplot(log_kitchen_sink, which = 2)
car::vif(log_kitchen_sink)
#Model Summary
msummary(log_kitchen_sink)
best <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, nbest = 1)
with(summary(best), data.frame(rsq, cp, outmat))
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + pace, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
stepwise <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, methodwith(summary(stepwise), data.frame(cp, outmat))
stepwise <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, method = "seqrep")
stepwise <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, method = "seqrep")
summary(stepwise)
stepwise <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, method = "seqrep")
with(summary(stepwise), data.frame(rsq, cp, outmat))
best <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, nbest = 1)
with(summary(best), data.frame(rsq, cp, outmat))
stepwise <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, method = "seqrep")
with(summary(stepwise), data.frame(rsq, cp, outmat))
#Five variable model
mod <- lm(log_value ~ passing + physic + dribbling + pace, data = players)
#Conditions
mplot(mod, which = 1)
mplot(mod, which = 2)
car::vif(mod)
#Model Summary
msummary(mod)
#Five variable model
mod2 <- lm(log_value ~ passing + physic + dribbling, data = players)
#Conditions
mplot(mod2, which = 1)
mplot(mod2, which = 2)
car::vif(mod2)
#Model Summary
msummary(mod2)
View(players)
ggplot(players, aes(x = player_group, y = passing)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
ggplot(players, aes(x = player_group, y = dribbling)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
#Boxplots
g <- ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("TITLE LATER")
#Boxplots
g <- ggplot(players, aes(x = player_group, y = value_eur)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("TITLE LATER")
#Boxplots
g <- ggplot(players, aes(x = player_group, y = value_eur)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("TITLE LATER")
#Boxplots
g <- ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
grid.arrange(g,h,i,j,k,l,m,n)
#Boxplots
g <- ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
h <- ggplot(players, aes(x = player_group, y = dribbling)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "dribbling rating") +
ggtitle("TITLE LATER")
i <- ggplot(players, aes(x = player_group, y = passing)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "passing rating") +
ggtitle("TITLE LATER")
k <- ggplot(players, aes(x = player_group, y = pace)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "pace raing") +
ggtitle("TITLE LATER")
l <- ggplot(players, aes(x = player_group, y = physicality)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "physicality rating") +
ggtitle("TITLE LATER")
m <- ggplot(players, aes(x = player_group, y = shooting)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "shooting rating") +
ggtitle("TITLE LATER")
n <- ggplot(players, aes(x = player_group, y = defending)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "defending rating") +
ggtitle("TITLE LATER")
grid.arrange(g,h,i,j,k,l,m,n)
grid.arrange(g,h,i,j,k,l,m)
#Boxplots
g <- ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
h <- ggplot(players, aes(x = player_group, y = dribbling)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "dribbling rating") +
ggtitle("TITLE LATER")
i <- ggplot(players, aes(x = player_group, y = passing)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "passing rating") +
ggtitle("TITLE LATER")
j <- ggplot(players, aes(x = player_group, y = pace)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "pace raing") +
ggtitle("TITLE LATER")
k <- ggplot(players, aes(x = player_group, y = physicality)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "physicality rating") +
ggtitle("TITLE LATER")
l <- ggplot(players, aes(x = player_group, y = shooting)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "shooting rating") +
ggtitle("TITLE LATER")
m <- ggplot(players, aes(x = player_group, y = defending)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "defending rating") +
ggtitle("TITLE LATER")
grid.arrange(g,h,i,j,k,l,m)
#Boxplots
g <- ggplot(players, aes(x = player_group, y = log_value)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
h <- ggplot(players, aes(x = player_group, y = dribbling)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "dribbling rating") +
ggtitle("TITLE LATER")
i <- ggplot(players, aes(x = player_group, y = passing)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "passing rating") +
ggtitle("TITLE LATER")
j <- ggplot(players, aes(x = player_group, y = pace)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "pace raing") +
ggtitle("TITLE LATER")
k <- ggplot(players, aes(x = player_group, y = physic)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "physicality rating") +
ggtitle("TITLE LATER")
l <- ggplot(players, aes(x = player_group, y = shooting)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "shooting rating") +
ggtitle("TITLE LATER")
m <- ggplot(players, aes(x = player_group, y = defending)) +
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "defending rating") +
ggtitle("TITLE LATER")
grid.arrange(g,h,i,j,k,l,m)
g <- ggplot(players, aes(x = player_group, y = log_value)) +  #SHOULD WE USE LOG OR NORMAL VALUE
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
g <- ggplot(players, aes(x = player_group, y = log_value)) +  #SHOULD WE USE LOG OR NORMAL VALUE
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
#Five variable model
mod2 <- lm(log_value ~ passing + physic + dribbling, data = players)
#Conditions
mplot(mod2, which = 1)
mplot(mod2, which = 2)
car::vif(mod2)
#Model Summary
msummary(mod2)
g <- ggplot(players, aes(x = player_group, y = log_value)) +  #SHOULD WE USE LOG OR NORMAL VALUE
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
#Boxplots
ggplot(players, aes(x = player_group, y = log_value)) +  #SHOULD WE USE LOG OR NORMAL VALUE
geom_boxplot(fill = "skyblue", color = "blue") +
labs(x = "Player Group", y = "log_value Euro") +
ggtitle("Boxplot of log_value Euro by Player Group")
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_group, data = players)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_group, data = players)
#Conditions
mplot(mod3, which = 1)
mplot(mod3, which = 2)
car::vif(mod3)
#Model Summary
msummary(mod3)
best <- regsubsets(log_value ~ pace + shooting + passing + physic + dribbling + defending, data = players, nbest = 1)
with(summary(best), data.frame(rsq, cp, outmat))
best3 <- regsubsets(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_group, data = players, nbest = 1)
with(summary(best3), data.frame(rsq, cp, outmat))
#Model with player_group
mod4 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_groupMidfielder, data = players)
# Convert player_group to a factor
players$player_group <- factor(players$player_group)
# Create dummy variables for player_group
dummy_vars <- model.matrix(~ player_group - 1, data = players)
# Combine dummy variables with other predictors
model_data <- cbind(players[, c("passing", "physic", "dribbling", "pace")], dummy_vars)
# Fit the linear regression model
model <- lm(log_value ~ ., data = model_data)
View(model_data)
players <- players |>
mutate(
is_attacker = ifelse(player_positions %in% c("CF", "SS", "ST", "LW", "RW"), 1, 0),
is_midfielder = ifelse(player_positions %in% c("LM", "LCM", "CM", "RCM", "RM", "CDM", "CAM"), 1, 0),
is_defender = ifelse(player_positions %in% c("LWB", "LB", "LCB", "CB", "RCB", "RB", "RWB", "SW"), 1, 0)
)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_attacker, is_midfielder, is_defender, data = players)
#Conditions
mplot(mod3, which = 1)
mplot(mod3, which = 1)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_attacker, is_midfielder, is_defender, data = players)
players <- players |>
mutate(
is_attacker = ifelse(player_positions %in% c("CF", "SS", "ST", "LW", "RW"), 1, 0),
is_midfielder = ifelse(player_positions %in% c("LM", "LCM", "CM", "RCM", "RM", "CDM", "CAM"), 1, 0),
is_defender = ifelse(player_positions %in% c("LWB", "LB", "LCB", "CB", "RCB", "RB", "RWB", "SW"), 1, 0)
)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_attacker, is_midfielder, is_defender, data = players)
#Conditions
mplot(mod3, which = 1)
players <- players |>
mutate(
is_attacker = ifelse(player_positions %in% c("CF", "SS", "ST", "LW", "RW"), 1, 0),
is_midfielder = ifelse(player_positions %in% c("LM", "LCM", "CM", "RCM", "RM", "CDM", "CAM"), 1, 0),
is_defender = ifelse(player_positions %in% c("LWB", "LB", "LCB", "CB", "RCB", "RB", "RWB", "SW"), 1, 0)
)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_attacker + is_midfielder + is_defender, data = players)
#Conditions
mplot(mod3, which = 1)
mplot(mod3, which = 2)
car::vif(mod3)
players <- players |>
mutate(
is_attacker = ifelse(player_positions %in% c("CF", "SS", "ST", "LW", "RW"), 1, 0),
is_midfielder = ifelse(player_positions %in% c("LM", "LCM", "CM", "RCM", "RM", "CDM", "CAM"), 1, 0),
is_defender = ifelse(player_positions %in% c("LWB", "LB", "LCB", "CB", "RCB", "RB", "RWB", "SW"), 1, 0)
)
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_midfielder + is_defender, data = players)
#Conditions
mplot(mod3, which = 1)
mplot(mod3, which = 2)
car::vif(mod3)
#Model Summary
msummary(mod3)
#Best Subsets
best3 <- regsubsets(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_group, data = players, nbest = 1)
with(summary(best3), data.frame(rsq, cp, outmat))
#Model with player_group
mod3 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + player_group, data = players)
#Conditions
mplot(mod3, which = 1)
mplot(mod3, which = 2)
car::vif(mod3)
#Model Summary
msummary(mod3)
View(mod)
with(summary(best3), data.frame(rsq, cp, outmat))
players <- players |>
mutate(is_midfielder = ifelse(player_positions %in% c("LM", "LCM", "CM", "RCM", "RM", "CDM", "CAM"), 1, 0))
#Model with player_group
mod4 <- lm(log_value ~ passing + physic + dribbling + pace + physic + shooting + is_midfielder, data = players)
#Conditions
mplot(mod4, which = 1)
mplot(mod4, which = 2)
car::vif(mod4)
#Model Summary
msummary(mod4)
#Final Model
mod4 <- lm(log_value ~ passing + physic + dribbling + is_midfielder, data = players)
#Conditions
mplot(mod4, which = 1)
mplot(mod4, which = 2)
car::vif(mod4)
#Model Summary
msummary(mod4)
